//HintName: TestIdUuidConverter.g.cs
// <auto-generated from Letterbook.Generators.TypedIdGenerator/>

using System;
using System.ComponentModel;
using System.Globalization;
using Medo;

namespace Letterbook.Generators.Tests;

public class TestIdUuidConverter : TypeConverter
{
	public override bool CanConvertFrom(ITypeDescriptorContext context, Type sourceType) =>
		sourceType == typeof(string);

	public override bool CanConvertTo(ITypeDescriptorContext context, Type destinationType) =>
		destinationType == typeof(string);

	public override object ConvertFrom(ITypeDescriptorContext context, CultureInfo culture, object value)
	{
		return value switch
		{
			string s => new TestIdUuid(TestIdUuid.FromString(s)),
			Uuid7 t => new TestIdUuid(t),
			null => null,
			_ => throw new ArgumentException($"Cannot convert from {value} to TestIdUuid", nameof(value))
		};
	}

	public override object ConvertTo(ITypeDescriptorContext context, CultureInfo culture, object value, Type destinationType)
	{
		if (destinationType == typeof(string))
		{
			return value switch
			{
				TestIdUuid id => id.ToString(),
				null => null,
				_ => throw new ArgumentException($"Cannot convert {value} to string", nameof(value))
			};
		}
		else if (destinationType == typeof(Uuid7))
		{
			return value switch
			{
				TestIdUuid id => id.Id,
				null => null,
				_ => throw new ArgumentException($"Cannot convert {value} to string", nameof(value))
			};
		}

		throw new ArgumentException($"Cannot convert {value ?? "(null)"} to {destinationType}", nameof(destinationType));
	}
}